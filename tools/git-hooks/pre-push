#!/bin/bash
set -euo pipefail

echo "ğŸš€ Running pre-push checks..."

#######################################
# Hard reset Go env (defensive)
#######################################
unset GOFLAGS
unset GOCOVERDIR
unset GOEXPERIMENT
unset GODEBUG

#######################################
# 1. Full lint
#######################################
echo "ğŸ” Running golangci-lint..."
golangci-lint run

#######################################
# 2. Unit tests (NO coverage)
#######################################
echo "ğŸ§ª Running unit tests..."
go test ./...

#######################################
# 3. Build validation
#######################################
echo "ğŸ—ï¸ Building application..."
go build ./cmd/app

echo "âœ… Pre-push checks passed!"
